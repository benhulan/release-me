<!DOCTYPE html>
<html>
<head>
  <% include ../partials/header.ejs %>
</head>

<body>

  <% include ../partials/nav.ejs %>

<div class="jumbotron text-center">
  <div class="container">
    <a href="/" class="lang-logo">
      <img src="/releaseme_logo4_no_road.svg">
    </a>
    <% include ../partials/carousel.ejs %>
    <a type="button" class="btn btn-lg btn-primary" href="#dashboard"><span class="glyphicon glyphicon-dashboard"></span> Let's Go!</a>   
  </div>
</div>

<div class="container">
  <hr>
  <div class="row" id="dashboard">
    <div class="col-md-6">
      <h3><span class="glyphicon glyphicon-dashboard"></span> Calculate your lease:</h3>
        <form>
          <div class="form-group">
            <label for="leaseDate">Enter the 

<!-- <label class="radio-inline"><input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1"> Start Date</label>
<label class="radio-inline"><input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2">--> End Date<!--</label> -->

             of your lease:</label>
            <input type="leaseDate" class="form-control" id="leaseDate" placeholder="08/01/2018">
          </div>

 <!--          <div class="checkbox">
            <label>
              <input type="checkbox"> 3 Year Lease (36 Month)
            </label>
            <label>
              <input type="checkbox"> 4 Year Lease (48 Month)
            </label>
            <label>
              <input type="checkbox"> 5 Year Lease (60 Month)
            </label>
          </div> -->

          <div class="form-group">
            <label for="currentMiles">Enter the current mileage of your leased vehicle:</label>
            <input type="currentMiles" class="form-control" id="currentMiles" placeholder="200">
          </div>
          <div class="form-group">
            <label for="targetMiles">Enter the target mileage for the end of the lease:</label>
            <input type="targetMiles" class="form-control" id="targetMiles" placeholder="15000">
          </div>

          <!-- <button type="submit" class="btn btn-default" id="submitButton">Submit</button> -->
        </form>
        <div class="padMe" style="padding-bottom: 10px;"></div>
    </div>
    <div class="col-md-6">

      <h3><span class="glyphicon glyphicon-info-sign"></span>Re-Lease Me! Results</h3>

       <div class="alert alert-info text-center" role="alert">
        <div id="result">As you edit the form, your results will replace this text.</div>
        <div id="answer"></div>
      </div>
<!--       <ul>
        <li><a href="#"><span class="glyphicon glyphicon-map-marker"></span> Commuter Map</a></li>
        <li><a href="#"><span class="glyphicon glyphicon-calendar"></span> Trip Planner</a></li>
        <li><a href="#"><span class="glyphicon glyphicon-piggy-bank"></span> Spending Log</a></li>       
      </ul> -->
    </div>
  </div> <!-- row -->
<!-- TripPlanner Modal -->
<div class="modal fade" id="tripPlanner" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Trip Planner</h4>
      </div>
      <div class="modal-body">
        <h2>This feature is under development</h2>
        <p><em>USER SCENARIO:</em> After calculating daily driving needs, the suer wants to plan a trip. How will this impact daily driving?</p>
        <p>Destination:  START   END</p>
        <p>Let's say the results indicate 700 extra miles needed over 2 days.</p>
        <p>Return strategies to reduce daily driving for 1 week, 2 weeks, 3 weeks, or 4.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
      </div>
    </div>
  </div>
</div>
</div>
<!-- End tripPlanner Modal -->

<!-- Spending Log Modal -->
<div class="modal fade" id="spendingLog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Spending Log</h4>
      </div>
      <div class="modal-body">
        <h2>This feature is under development</h2>
        <p><em>Are you our target user? What feature would you like to see here?</em></p>
      <div class="checkbox">
            <label><input type="checkbox" name="optA"> OPTION A: Track cost of lease. Could this be tied to interest rates API and ask user to enter credit score?</label>
            <label><input type="checkbox" name="optB"> OPTION B: Track only monthly spending on lease.</label>
            <label><input type="checkbox" name="optC"> OPTION C: Track fuel economy / gas log. Seems less relevant.</label>
          </div> 
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" id="prefs">Submit preferences</button>
      </div>
    </div>
  </div>
</div>
</div>
<!-- End spendingLog Modal -->
<script type="text/javascript">
var currentMiles, targetMiles, remainingMiles;
  var today = new Date();
  var diffDays;
  var m_names = new Array("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec");

  var curr_date = today.getDate();
  var curr_month = today.getMonth();
  var curr_year = today.getFullYear();
  $("#todayDate").html(m_names[curr_month] + ". " + curr_date + ", " + curr_year);

  $("#leaseDate").datepicker();
  var resultString = "";

  var daysLeft = function() {
    var a = $( "#leaseDate" ).datepicker('getDate').getTime();
    var b = today.getTime();
    var c = 24*60*60*1000, // hours per day, minutes per hour, seconds per minute, ms per sec
    diffDays = Math.round((a - b)/c);
    if (diffDays < 0 ) {
      resultString = "Please pick a date in the future.";
    } else {
      resultString = ("You have " + diffDays + " days left on your lease.");
    } return diffDays;
  };

  $("#leaseDate").on("change", function(){
    daysLeft();
    $("#result").html(resultString);
  });
/* THE OLD WAY - SHOW RESULTS ON CHANGE  */

  $("#currentMiles").on("change", function(){
    currentMiles = $("#currentMiles").val();
    if (targetMiles) { 
      targetMiles = $("#targetMiles").val();
      remainingMiles = (targetMiles - currentMiles);
      $("#answer").html("You need to drive less than  " + Math.round(remainingMiles/daysLeft())+ " miles per day.");
    } else { 
      return;
    }
  });

  $("#targetMiles").on("change", function(){
    targetMiles = $("#targetMiles").val();
    if (currentMiles) { 
      currentMiles = $("#currentMiles").val();
      remainingMiles = (targetMiles - currentMiles);
      $("#answer").html("You need to drive less than  " + Math.round(remainingMiles/daysLeft()) + " miles per day.");
    } else { 
      return;
    }
  });

</script>

</body>
</html>
